{
 "<h1>MLP-Mixer: An all-MLP Architecture for Vision</h1>\n<p>This is a <a href=\"https://pytorch.org\">PyTorch</a> implementation of the paper <a href=\"https://papers.labml.ai/paper/2105.01601\">MLP-Mixer: An all-MLP Architecture for Vision</a>.</p>\n<p>This paper applies the model on vision tasks. The model is similar to a transformer with attention layer being replaced by a MLP that is applied across the patches (or tokens in case of a NLP task).</p>\n<p>Our implementation of MLP Mixer is a drop in replacement for the <a href=\"../mha.html\">self-attention layer</a> in <a href=\"../models.html\">our transformer implementation</a>. So it&#x27;s just a couple of lines of code, transposing the tensor to apply the MLP across the sequence dimension.</p>\n<p>Although the paper applied MLP Mixer on vision tasks, we tried it on a <a href=\"../mlm/index.html\">masked language model</a>. <a href=\"experiment.html\">Here is the experiment code</a>.</p>\n<p><a href=\"https://app.labml.ai/run/994263d2cdb511eb961e872301f0dbab\"><span translate=no>_^_0_^_</span></a></p>\n": "<h1>\u0d91\u0db8\u0dca\u0d91\u0dbd\u0dca\u0db4\u0dd3-\u0db8\u0dd2\u0d9a\u0dca\u0dc3\u0dbb\u0dca: \u0daf\u0dd0\u0d9a\u0dca\u0db8 \u0dc3\u0db3\u0dc4\u0dcf \u0dc3\u0dbb\u0dca\u0dc0 \u0d91\u0db8\u0dca\u0d91\u0dbd\u0dca\u0db4\u0dd3 \u0d9c\u0dd8\u0dc4 \u0db1\u0dd2\u0dbb\u0dca\u0db8\u0dcf\u0dab \u0dc1\u0dd2\u0dbd\u0dca\u0db4\u0dba\u0d9a\u0dca</h1>\n<p>\u0db8\u0dd9\u0dba\u0d9a\u0da9\u0daf\u0dcf\u0dc3\u0dd2 <a href=\"https://papers.labml.ai/paper/2105.01601\">\u0d91\u0db8\u0dca\u0d91\u0dbd\u0dca\u0db4\u0dd3-\u0db8\u0dd2\u0d9a\u0dca\u0dc3\u0dbb\u0dca \u0dc4\u0dd2 <a href=\"https://pytorch.org\">\u0db4\u0dba\u0dd2\u0da7\u0ddd\u0da0\u0dca</a> \u0d9a\u0dca\u0dbb\u0dd2\u0dba\u0dcf\u0dad\u0dca\u0db8\u0d9a \u0d9a\u0dd2\u0dbb\u0dd3\u0db8\u0dba\u0dd2: \u0daf\u0dd0\u0d9a\u0dca\u0db8 \u0dc3\u0db3\u0dc4\u0dcf \u0dc3\u0dbb\u0dca\u0dc0 \u0d91\u0db8\u0dca\u0d91\u0dbd\u0dca\u0db4\u0dd3 \u0d9c\u0dd8\u0dc4 \u0db1\u0dd2\u0dbb\u0dca\u0db8\u0dcf\u0dab \u0dc1\u0dd2\u0dbd\u0dca\u0db4\u0dba</a> . </p>\n<p>\u0db8\u0dd9\u0db8\u0dbd\u0dd2\u0db4\u0dd2\u0dba \u0daf\u0dbb\u0dca\u0dc1\u0db1 \u0d9a\u0dcf\u0dbb\u0dca\u0dba\u0dba\u0db1\u0dca \u0db4\u0dd2\u0dc5\u0dd2\u0db6\u0db3 \u0d86\u0d9a\u0dd8\u0dad\u0dd2\u0dba \u0d85\u0daf\u0dcf\u0dc5 \u0dc0\u0dda. \u0d86\u0d9a\u0dd8\u0dad\u0dd2\u0dba \u0da7\u0dca\u0dbb\u0dcf\u0db1\u0dca\u0dc3\u0dca\u0dc6\u0ddd\u0db8\u0dbb\u0dba\u0d9a\u0da7 \u0dc3\u0db8\u0dcf\u0db1 \u0dc0\u0db1 \u0d85\u0dad\u0dbb \u0d85\u0dc0\u0db0\u0dcf\u0db1\u0dba \u0dba\u0ddc\u0db8\u0dd4 \u0d9a\u0dbb\u0db1 \u0dad\u0da7\u0dca\u0da7\u0dd4\u0dc0\u0d9a\u0dca \u0db4\u0dd0\u0da0\u0dca \u0dc4\u0dbb\u0dc4\u0dcf \u0dba\u0ddc\u0daf\u0db1 \u0d91\u0db8\u0dca\u0d91\u0dbd\u0dca\u0db4\u0dd3 \u0db8\u0d9c\u0dd2\u0db1\u0dca \u0db4\u0dca\u0dbb\u0dad\u0dd2\u0dc3\u0dca\u0dae\u0dcf\u0db4\u0db1\u0dba \u0dc0\u0dda (\u0dc4\u0ddd \u0d91\u0db1\u0dca\u0d91\u0dbd\u0dca\u0db4\u0dd3 \u0d9a\u0dbb\u0dca\u0dad\u0dc0\u0dca\u0dba\u0dba\u0d9a\u0daf\u0dd3 \u0da7\u0ddd\u0d9a\u0db1). </p>\n<p>MLPMixer \u0d85\u0db4\u0d9c\u0dda \u0d9a\u0dca\u0dbb\u0dd2\u0dba\u0dcf\u0dad\u0dca\u0db8\u0d9a \u0d9a\u0dd2\u0dbb\u0dd3\u0db8 <a href=\"../models.html\">\u0d85\u0db4\u0d9c\u0dda \u0da7\u0dca\u0dbb\u0dcf\u0db1\u0dca\u0dc3\u0dca\u0dc6\u0ddd\u0db8\u0dbb\u0dca \u0d9a\u0dca\u0dbb\u0dd2\u0dba\u0dcf\u0dad\u0dca\u0db8\u0d9a \u0d9a\u0dd2\u0dbb\u0dd3\u0db8</a> <a href=\"../mha.html\">\u0dc3\u0dca\u0dc0\u0dba\u0d82 \u0d85\u0dc0\u0db0\u0dcf\u0db1\u0dba \u0dc3\u0dca\u0dae\u0dbb\u0dba</a> \u0dc3\u0db3\u0dc4\u0dcf \u0dc0\u0dd9\u0db1\u0dd4\u0dc0\u0da7 \u0db4\u0dc4\u0dad \u0dc0\u0dd0\u0da7\u0dd3\u0db8\u0d9a\u0dca \u0dc0\u0dda. \u0d91\u0db6\u0dd0\u0dc0\u0dd2\u0db1\u0dca \u0d91\u0dba \u0d9a\u0dda\u0dad \u0db4\u0dda\u0dc5\u0dd2 \u0d9a\u0dd2\u0dc4\u0dd2\u0db4\u0dba\u0d9a\u0dca \u0db4\u0db8\u0dab\u0d9a\u0dca \u0dc0\u0db1 \u0d85\u0dad\u0dbb, \u0d85\u0db1\u0dd4\u0d9a\u0dca\u0dbb\u0db8\u0dd2\u0d9a \u0db8\u0dcf\u0db1\u0dba \u0dc4\u0dbb\u0dc4\u0dcf \u0d91\u0db8\u0dca\u0d91\u0dbd\u0dca\u0db4\u0dd3 \u0dba\u0dd9\u0daf\u0dd3\u0db8 \u0dc3\u0db3\u0dc4\u0dcf \u0da7\u0dd9\u0db1\u0dca\u0dc3\u0dbb\u0dba \u0dc3\u0db8\u0dca\u0db4\u0dca\u0dbb\u0dda\u0dc2\u0dab\u0dba \u0d9a\u0dbb\u0dba\u0dd2. </p>\n<p>\u0d9a\u0da9\u0daf\u0dcf\u0dc3\u0dd2\u0daf\u0dbb\u0dca\u0dc1\u0db1 \u0d9a\u0dcf\u0dbb\u0dca\u0dba\u0dba\u0db1\u0dca \u0dc3\u0db3\u0dc4\u0dcf \u0d91\u0db8\u0dca\u0d91\u0dbd\u0dca\u0db4\u0dd3 \u0db8\u0dd2\u0d9a\u0dca\u0dc3\u0dbb\u0dca \u0dba\u0dd9\u0daf\u0dd4\u0dc0\u0daf, \u0d85\u0db4\u0dd2 \u0d91\u0dba <a href=\"../mlm/index.html\">\u0dc0\u0dd9\u0dc3\u0dca \u0db7\u0dcf\u0dc2\u0dcf \u0d86\u0d9a\u0dd8\u0dad\u0dd2\u0dba\u0d9a\u0dca</a>\u0db8\u0dad \u0d8b\u0dad\u0dca\u0dc3\u0dcf\u0dc4 \u0d9a\u0dc5\u0dd9\u0db8\u0dd4. <a href=\"experiment.html\">\u0db8\u0dd9\u0db1\u0dca\u0db1 \u0d85\u0dad\u0dca\u0dc4\u0daf\u0dcf \u0db6\u0dd0\u0dbd\u0dd3\u0db8\u0dda \u0d9a\u0dda\u0dad\u0dba</a>. </p>\n<p><a href=\"https://app.labml.ai/run/994263d2cdb511eb961e872301f0dbab\"><span translate=no>_^_0_^_</span></a></p>\n",
 "<h2>MLP Mixer</h2>\n<p>This module is a drop-in replacement for <a href=\"../mha.html\">self-attention layer</a>. It transposes the input tensor before feeding it to the MLP and transposes back, so that the MLP is applied across the sequence dimension (across tokens or image patches) instead of the feature dimension.</p>\n": "<h2>MLP\u0db8\u0dd2\u0d9a\u0dca\u0dc3\u0dbb\u0dca</h2>\n<p>\u0db8\u0dd9\u0db8\u0db8\u0ddc\u0da9\u0dd2\u0dba\u0dd4\u0dbd\u0dba <a href=\"../mha.html\">\u0dc3\u0dca\u0dc0\u0dba\u0d82 \u0d85\u0dc0\u0db0\u0dcf\u0db1\u0dba \u0dc3\u0dca\u0dae\u0dbb\u0dba</a>\u0dc3\u0db3\u0dc4\u0dcf \u0db4\u0dad\u0db1 \u0dc0\u0dd9\u0db1\u0dd4\u0dc0\u0da7 \u0dc0\u0dda. \u0d91\u0dba \u0d91\u0db8\u0dca\u0d91\u0dbd\u0dca\u0db4\u0dd3 \u0dc0\u0dd9\u0dad \u0db4\u0ddd\u0dc2\u0dab\u0dba \u0d9a\u0dd2\u0dbb\u0dd3\u0db8\u0da7 \u0db4\u0dd9\u0dbb \u0d86\u0daf\u0dcf\u0db1 \u0da7\u0dd9\u0db1\u0dca\u0dc3\u0dbb\u0dba \u0dc3\u0db8\u0dca\u0db4\u0dca\u0dbb\u0dda\u0dc2\u0dab\u0dba \u0d9a\u0dbb \u0d86\u0db4\u0dc3\u0dd4 \u0dc3\u0db8\u0dca\u0db4\u0dca\u0dbb\u0dda\u0dc2\u0dab\u0dba \u0d9a\u0dbb\u0dba\u0dd2, \u0d91\u0dc0\u0dd2\u0da7 \u0d91\u0db8\u0dca\u0d91\u0dbd\u0dca\u0db4\u0dd3 \u0dc0\u0dd2\u0dc1\u0dda\u0dc2\u0dcf\u0d82\u0d9c \u0db8\u0dcf\u0db1\u0dba \u0dc0\u0dd9\u0db1\u0dd4\u0dc0\u0da7 \u0d85\u0db1\u0dd4\u0d9a\u0dca\u0dbb\u0db8\u0dd2\u0d9a \u0db8\u0dcf\u0db1\u0dba \u0dc4\u0dbb\u0dc4\u0dcf (\u0da7\u0ddd\u0d9a\u0db1 \u0dc4\u0ddd \u0dbb\u0dd6\u0db4 \u0db4\u0dd0\u0da0\u0dca \u0dc4\u0dbb\u0dc4\u0dcf) \u0dba\u0ddc\u0daf\u0db1\u0dd4 \u0dbd\u0dd0\u0db6\u0dda. </p>\n",
 "<p> </p>\n": "<p> </p>\n",
 "<p> The <a href=\"../mha.html\">normal attention module</a> can be fed with different token embeddings for <span translate=no>_^_0_^_</span>,<span translate=no>_^_1_^_</span>, and <span translate=no>_^_2_^_</span> and a mask.</p>\n<p>We follow the same function signature so that we can replace it directly.</p>\n<p>For MLP mixing, <span translate=no>_^_3_^_</span> and masking is not possible. Shape of <span translate=no>_^_4_^_</span> (and <span translate=no>_^_5_^_</span> and <span translate=no>_^_6_^_</span>) is <span translate=no>_^_7_^_</span>.</p>\n": "<p> <a href=\"../mha.html\">\u0dc3\u0dcf\u0db8\u0dcf\u0db1\u0dca\u0dba \u0d85\u0dc0\u0db0\u0dcf\u0db1\u0dba \u0dba\u0ddc\u0db8\u0dd4 \u0d9a\u0dd2\u0dbb\u0dd3\u0db8\u0dda \u0db8\u0ddc\u0da9\u0dd2\u0dba\u0dd4\u0dbd\u0dba</a> \u0dc3\u0db3\u0dc4\u0dcf <span translate=no>_^_0_^_</span>\u0dc0\u0dd2\u0dc0\u0dd2\u0db0 \u0da7\u0ddd\u0d9a\u0db1 \u0d9a\u0dcf\u0dc0\u0dd0\u0daf\u0dca\u0daf\u0dd3\u0db8\u0dca <span translate=no>_^_2_^_</span> \u0dc3\u0dc4 \u0dc0\u0dd9\u0dc3\u0dca \u0db8\u0dd4\u0dc4\u0dd4\u0dab\u0d9a\u0dca \u0dc3\u0db8\u0d9f \u0db4\u0ddd\u0dc2\u0dab\u0dba \u0d9a\u0dc5 \u0dc4\u0dd0\u0d9a\u0dd2\u0dba.<span translate=no>_^_1_^_</span> </p>\n<p>\u0d85\u0db4\u0dd2\u0d91\u0d9a\u0db8 \u0d9a\u0dca\u0dbb\u0dd2\u0dba\u0dcf\u0d9a\u0dcf\u0dbb\u0dd3 \u0d85\u0dad\u0dca\u0dc3\u0db1 \u0d85\u0db1\u0dd4\u0d9c\u0db8\u0db1\u0dba \u0d9a\u0dbb\u0db1 \u0d85\u0dad\u0dbb \u0d91\u0db8\u0d9f\u0dd2\u0db1\u0dca \u0d85\u0db4\u0da7 \u0d91\u0dba \u0d9a\u0dd9\u0dbd\u0dd2\u0db1\u0dca\u0db8 \u0db4\u0dca\u0dbb\u0dad\u0dd2\u0dc3\u0dca\u0dae\u0dcf\u0db4\u0db1\u0dba \u0d9a\u0dc5 \u0dc4\u0dd0\u0d9a\u0dd2\u0dba. </p>\n<p>MLP\u0db8\u0dd2\u0dc1\u0dca\u0dbb \u0d9a\u0dd2\u0dbb\u0dd3\u0db8 \u0dc3\u0db3\u0dc4\u0dcf, <span translate=no>_^_3_^_</span> \u0dc3\u0dc4 \u0d86\u0dc0\u0dbb\u0dab \u0d9a\u0dd2\u0dbb\u0dd3\u0db8 \u0d9a\u0dc5 \u0db1\u0ddc\u0dc4\u0dd0\u0d9a. <span translate=no>_^_4_^_</span> ( \u0dc3\u0dc4 <span translate=no>_^_5_^_</span> \u0dc3\u0dc4 <span translate=no>_^_6_^_</span>) \u0dc4\u0dd0\u0da9\u0dba \u0dc0\u0dda <span translate=no>_^_7_^_</span>. </p>\n",
 "<p><span translate=no>_^_0_^_</span>,<span translate=no>_^_1_^_</span>, and <span translate=no>_^_2_^_</span> all should be the same </p>\n": "<p><span translate=no>_^_0_^_</span>,<span translate=no>_^_1_^_</span>, \u0dc3\u0dc4 <span translate=no>_^_2_^_</span> \u0dc3\u0dd2\u0dba\u0dbd\u0dca\u0dbd \u0d91\u0d9a \u0dc4\u0dcf \u0dc3\u0db8\u0dcf\u0db1 \u0dc0\u0dd2\u0dba \u0dba\u0dd4\u0dad\u0dd4\u0dba </p>\n",
 "<p>Apply the MLP across tokens </p>\n": "<p>\u0da7\u0ddd\u0d9a\u0db1\u0dc4\u0dbb\u0dc4\u0dcf \u0d91\u0db8\u0dca\u0d91\u0dbd\u0dca\u0db4\u0dd3 \u0dba\u0ddc\u0daf\u0db1\u0dca\u0db1 </p>\n",
 "<p>Assign to <span translate=no>_^_0_^_</span> for clarity </p>\n": "<p>\u0db4\u0dd0\u0dc4\u0dd0\u0daf\u0dd2\u0dbd\u0dd2\u0d9a\u0db8 <span translate=no>_^_0_^_</span> \u0dc3\u0db3\u0dc4\u0dcf \u0db4\u0dc0\u0dbb\u0db1\u0dca\u0db1 </p>\n",
 "<p>MLP mixer doesn&#x27;t support masking. i.e. all tokens will see all other token embeddings. </p>\n": "<p>MLP\u0db8\u0dd2\u0d9a\u0dca\u0dc3\u0dbb\u0dca \u0d86\u0dc0\u0dbb\u0dab \u0dc3\u0db3\u0dc4\u0dcf \u0dc3\u0dc4\u0dba \u0db1\u0ddc\u0daf\u0d9a\u0dca\u0dc0\u0dba\u0dd2. \u0d91\u0db1\u0db8\u0dca \u0dc3\u0dd2\u0dba\u0dbd\u0dd4\u0db8 \u0da7\u0ddd\u0d9a\u0db1 \u0db8\u0d9c\u0dd2\u0db1\u0dca \u0d85\u0db1\u0dd9\u0d9a\u0dd4\u0dad\u0dca \u0dc3\u0dd2\u0dba\u0dbd\u0dd4\u0db8 \u0da7\u0ddd\u0d9a\u0db1 \u0d9a\u0dcf\u0dc0\u0dd0\u0daf\u0dca\u0daf\u0dd3\u0db8\u0dca \u0daf\u0d9a\u0dd2\u0db1\u0dd4 \u0d87\u0dad. </p>\n",
 "<p>Transpose back into original form </p>\n": "<p>\u0db1\u0dd0\u0dc0\u0dad\u0db8\u0dd4\u0dbd\u0dca \u0dc3\u0dca\u0dc0\u0dbb\u0dd6\u0db4\u0dba\u0da7 \u0db4\u0dbb\u0dd2\u0dc0\u0dbb\u0dca\u0dad\u0db1\u0dba \u0d9a\u0dbb\u0db1\u0dca\u0db1 </p>\n",
 "<p>Transpose so that the last dimension is the sequence dimension. New shape is <span translate=no>_^_0_^_</span> </p>\n": "<p>\u0d85\u0dc0\u0dc3\u0dcf\u0db1\u0db8\u0dcf\u0db1\u0dba \u0d85\u0db1\u0dd4\u0d9a\u0dca\u0dbb\u0db8\u0dba \u0db8\u0dcf\u0db1\u0dba\u0d9a\u0dca \u0db6\u0dc0 \u0d91\u0dc3\u0dda \u0dc3\u0db8\u0dca\u0db4\u0dca\u0dbb\u0dda\u0dc2\u0dab\u0dba \u0d9a\u0dbb\u0db1\u0dca\u0db1. \u0db1\u0dc0 \u0dc4\u0dd0\u0da9\u0dba <span translate=no>_^_0_^_</span> </p>\n",
 "<ul><li><span translate=no>_^_0_^_</span> is the MLP module.</li></ul>\n": "<ul><li><span translate=no>_^_0_^_</span> MLP \u0db8\u0ddc\u0da9\u0dd2\u0dba\u0dd4\u0dbd\u0dba \u0dc0\u0dda. </li></ul>\n",
 "MLP-Mixer: An all-MLP Architecture for Vision": "\u0d91\u0db8\u0dca\u0d91\u0dbd\u0dca\u0db4\u0dd3-\u0db8\u0dd2\u0d9a\u0dca\u0dc3\u0dbb\u0dca: \u0daf\u0dd0\u0d9a\u0dca\u0db8 \u0dc3\u0db3\u0dc4\u0dcf \u0dc3\u0dbb\u0dca\u0dc0 \u0d91\u0db8\u0dca\u0d91\u0dbd\u0dca\u0db4\u0dd3 \u0d9c\u0dd8\u0dc4 \u0db1\u0dd2\u0dbb\u0dca\u0db8\u0dcf\u0dab \u0dc1\u0dd2\u0dbd\u0dca\u0db4\u0dba\u0d9a\u0dca",
 "This is an annotated implementation/tutorial of MLP-Mixer: An all-MLP Architecture for Vision in PyTorch.": "\u0db8\u0dd9\u0dba \u0d91\u0db8\u0dca\u0d91\u0dbd\u0dca\u0db4\u0dd3-\u0db8\u0dd2\u0d9a\u0dca\u0dc3\u0dbb\u0dca\u0dc4\u0dd2 \u0dc0\u0dd2\u0d9a\u0da7 \u0d9a\u0dca\u0dbb\u0dd2\u0dba\u0dcf\u0dad\u0dca\u0db8\u0d9a \u0d9a\u0dd2\u0dbb\u0dd3\u0db8/\u0db1\u0dd2\u0db6\u0db1\u0dca\u0db0\u0db1\u0dba\u0d9a\u0dd2: PyTorch \u0dc4\u0dd2 \u0daf\u0dd0\u0d9a\u0dca\u0db8 \u0dc3\u0db3\u0dc4\u0dcf \u0dc3\u0dbb\u0dca\u0dc0 \u0d91\u0db8\u0dca\u0d91\u0dbd\u0dca\u0db4\u0dd3 \u0d9c\u0dd8\u0dc4 \u0db1\u0dd2\u0dbb\u0dca\u0db8\u0dcf\u0dab \u0dc1\u0dd2\u0dbd\u0dca\u0db4\u0dba\u0d9a\u0dd2."
}