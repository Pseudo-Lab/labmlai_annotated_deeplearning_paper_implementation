<!DOCTYPE html>
<html lang="">

<head>
    <meta http-equiv="content-type" content="text/html;charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />

    <meta name="twitter:card" content="summary" />
    <meta name="twitter:image:src" content="https://avatars1.githubusercontent.com/u/64068543?s=400&amp;v=4" />
    <meta name="twitter:title" content="Compressive Transformer" />
    <meta name="twitter:description" content="" />
    <meta name="twitter:site" content="@labmlai" />
    <meta name="twitter:creator" content="@labmlai" />

    <meta property="og:url" content="https://nn.labml.ai/transformers/compressive/readme.html" />
    <meta property="og:title" content="Compressive Transformer" />
    <meta property="og:image" content="https://avatars1.githubusercontent.com/u/64068543?s=400&amp;v=4" />
    <meta property="og:site_name" content="Compressive Transformer" />
    <meta property="og:type" content="object" />
    <meta property="og:title" content="Compressive Transformer" />
    <meta property="og:description" content="" />

    <title>Compressive Transformer</title>
    <link rel="shortcut icon" href="/icon.png" />
    <link rel="stylesheet" href="../../pylit.css?v=1">
    <link rel="canonical" href="https://nn.labml.ai/transformers/compressive/readme.html" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/katex.min.css"
        integrity="sha384-zTROYFVGOfTw7JV7KUu8udsvW2fx4lWOsCEDqhBreBwlHI4ioVRtmIvEThzJHGET" crossorigin="anonymous">

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-4V3HC8HBLH"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }

        gtag('js', new Date());

        gtag('config', 'G-4V3HC8HBLH');
    </script>
</head>

<body>
    <div id='container'>
        <div id="background"></div>
        <div class='section'>
            <div class='docs'>
                <p>
                    <a class="parent" href="/">home</a>
                    <a class="parent" href="../index.html">transformers</a>
                    <a class="parent" href="index.html">compressive</a>
                </p>
                <p>
                    <a href="https://github.com/labmlai/annotated_deep_learning_paper_implementations" target="_blank">
                        <img alt="Github"
                            src="https://img.shields.io/github/stars/labmlai/annotated_deep_learning_paper_implementations?style=social"
                            style="max-width:100%;" /></a>
                    <a href="https://twitter.com/labmlai" rel="nofollow" target="_blank">
                        <img alt="Twitter" src="https://img.shields.io/twitter/follow/labmlai?style=social"
                            style="max-width:100%;" /></a>
                </p>
                <p>
                    <a href="https://github.com/labmlai/annotated_deep_learning_paper_implementations/tree/master/labml_nn/transformers/compressive/readme.md"
                        target="_blank">
                        View code on Github</a>
                </p>
            </div>
        </div>
        <div class='section' id='section-0'>
            <div class='docs'>
                <div class='section-link'>
                    <a href='#section-0'>#</a>
                </div>
                <h1><a href="https://nn.labml.ai/transformers/compressive/index.html">Compressive Transformer</a></h1>
                <p><a href="https://papers.labml.ai/paper/1911.05507">Compressive
                        Transformers for Long-Range Sequence Modelling</a>를 <a href="https://pytorch.org">PyTorch</a>로
                    구현한 내용에 대한 문서입니다.</p>
                <p>과거의 메모리를 압축하여 더 긴 어텐션 범위를 제공하는 <a href="../xl/index.html">Transformer XL</a>의 확장입니다. 즉, 가장 먼
                    <span><span class="katex"><span aria-hidden="true" class="katex-html"><span class="base"><span
                                        class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span
                                        class="mord coloredeq eqi" style=""><span class="mord" style=""><span
                                                class="mord mathnormal" style="">n</span><span class="msupsub"><span
                                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                            style="height:0.151392em;"><span
                                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                    class="pstrut" style="height:2.7em;"></span><span
                                                                    class="sizing reset-size6 size3 mtight"
                                                                    style=""><span class="mord mtight" style=""><span
                                                                            class="mord mtight" style=""><span
                                                                                class="mord mathnormal mtight coloredeq eqk"
                                                                                style="">c</span></span><span
                                                                            class="mord mathnormal mtight"
                                                                            style="">m</span></span></span></span></span><span
                                                            class="vlist-s">​</span></span><span class="vlist-r"><span
                                                            class="vlist"
                                                            style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                        class="mord coloredeq eqk" style=""><span class="mord mathnormal"
                                            style="">c</span></span></span></span></span></span>의 기억은 <span><span
                            class="katex"><span aria-hidden="true" class="katex-html"><span class="base"><span
                                        class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span
                                        class="mord coloredeq eqi" style=""><span class="mord" style=""><span
                                                class="mord mathnormal" style="">n</span><span class="msupsub"><span
                                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                            style="height:0.151392em;"><span
                                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                    class="pstrut" style="height:2.7em;"></span><span
                                                                    class="sizing reset-size6 size3 mtight"
                                                                    style=""><span class="mord mtight" style=""><span
                                                                            class="mord mtight" style=""><span
                                                                                class="mord mathnormal mtight coloredeq eqk"
                                                                                style="">c</span></span><span
                                                                            class="mord mathnormal mtight"
                                                                            style="">m</span></span></span></span></span><span
                                                            class="vlist-s">​</span></span><span class="vlist-r"><span
                                                            class="vlist"
                                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></span>
                    메모리로 압축되며, 여기서 <span><span class="katex"><span aria-hidden="true" class="katex-html"><span
                                    class="base"><span class="strut"
                                        style="height:0.43056em;vertical-align:0em;"></span><span
                                        class="mord coloredeq eqk" style=""><span class="mord mathnormal"
                                            style="">c</span></span></span></span></span></span>는 압축률입니다.
                </p>
                <h2>압축 작업</h2>
                <p>압축 작업은 다음과 같이 정의됩니다. <span><span class="katex"><span aria-hidden="true" class="katex-html"><span
                                    class="base"><span class="strut"
                                        style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span
                                        class="mord coloredeq eqj" style=""><span class="mord" style=""><span
                                                class="mord mathnormal" style="margin-right:0.10764em">f</span><span
                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                        class="vlist-r"><span class="vlist"
                                                            style="height:0.151392em;"><span
                                                                style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span
                                                                    class="pstrut" style="height:2.7em;"></span><span
                                                                    class="sizing reset-size6 size3 mtight"
                                                                    style=""><span class="mord mtight" style=""><span
                                                                            class="mord mathnormal mtight coloredeq eqk"
                                                                            style="">c</span></span></span></span></span><span
                                                            class="vlist-s">​</span></span><span class="vlist-r"><span
                                                            class="vlist"
                                                            style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                        class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                                        class="mrel">:</span><span class="mspace"
                                        style="margin-right:0.2777777777777778em;"></span></span><span
                                    class="base"><span class="strut"
                                        style="height:0.8491079999999999em;vertical-align:0em;"></span><span
                                        class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span
                                                class="vlist-t"><span class="vlist-r"><span class="vlist"
                                                        style="height:0.8491079999999999em;"><span
                                                            style="top:-3.063em;margin-right:0.05em;"><span
                                                                class="pstrut" style="height:2.7em;"></span><span
                                                                class="sizing reset-size6 size3 mtight"><span
                                                                    class="mord mtight"><span
                                                                        class="mord mathnormal mtight">n</span><span
                                                                        class="mord mtight coloredeq eqk" style=""><span
                                                                            class="mord mathnormal mtight"
                                                                            style="">c</span></span><span
                                                                        class="mbin mtight">×</span><span
                                                                        class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span><span
                                        class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                                        class="mrel">→</span><span class="mspace"
                                        style="margin-right:0.2777777777777778em;"></span></span><span
                                    class="base"><span class="strut"
                                        style="height:0.8491079999999999em;vertical-align:0em;"></span><span
                                        class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span
                                                class="vlist-t"><span class="vlist-r"><span class="vlist"
                                                        style="height:0.8491079999999999em;"><span
                                                            style="top:-3.063em;margin-right:0.05em;"><span
                                                                class="pstrut" style="height:2.7em;"></span><span
                                                                class="sizing reset-size6 size3 mtight"><span
                                                                    class="mord mtight"><span
                                                                        class="mord mathnormal mtight">n</span><span
                                                                        class="mbin mtight">×</span><span
                                                                        class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span></span></span></span>.
                    이 논문에서는 <span><span class="katex"><span aria-hidden="true" class="katex-html"><span
                                    class="base"><span class="strut"
                                        style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span
                                        class="mord coloredeq eqj" style=""><span class="mord" style=""><span
                                                class="mord mathnormal" style="margin-right:0.10764em">f</span><span
                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                        class="vlist-r"><span class="vlist"
                                                            style="height:0.151392em;"><span
                                                                style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span
                                                                    class="pstrut" style="height:2.7em;"></span><span
                                                                    class="sizing reset-size6 size3 mtight"
                                                                    style=""><span class="mord mtight" style=""><span
                                                                            class="mord mathnormal mtight coloredeq eqk"
                                                                            style="">c</span></span></span></span></span><span
                                                            class="vlist-s">​</span></span><span class="vlist-r"><span
                                                            class="vlist"
                                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></span>
                    에 대한 여러 선택지를 소개하며, 저희는 가장 좋은 결과를 제공하는 것으로 보이는 1D 컨볼루션만 구현하였습니다. 각 레이어는 별도의 압축 연산<span><span
                            class="katex"><span aria-hidden="true" class="katex-html"><span class="base"><span
                                        class="strut" style="height:1.16678em;vertical-align:-0.19444em;"></span><span
                                        class="mord coloredeq eqe" style=""><span class="mord" style=""><span
                                                class="mord" style=""><span class="mord coloredeq eqj" style=""><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.10764em">f</span><span
                                                        class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.151392em;"><span
                                                                        style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"
                                                                            style=""><span class="mord mtight"
                                                                                style=""><span
                                                                                    class="mord mathnormal mtight coloredeq eqk"
                                                                                    style="">c</span></span></span></span></span><span
                                                                    class="vlist-s">​</span></span><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                class="msupsub"><span class="vlist-t"><span class="vlist-r"><span
                                                            class="vlist" style="height:0.97234em;"><span
                                                                style="top:-3.14734em;margin-right:0.05em;"><span
                                                                    class="pstrut" style="height:2.7em;"></span><span
                                                                    class="sizing reset-size6 size3 mtight"
                                                                    style=""><span class="mord mtight" style=""><span
                                                                            class="mopen mtight" style="">(</span><span
                                                                            class="mord mtight" style=""><span
                                                                                class="mord mathnormal mtight coloredeq eql"
                                                                                style="">i</span></span><span
                                                                            class="mclose mtight"
                                                                            style="">)</span></span></span></span></span></span></span></span></span></span></span></span></span></span>
                    를 갖고 있으며, <span><span class="katex"><span aria-hidden="true" class="katex-html"><span
                                    class="base"><span class="strut"
                                        style="height:0.65952em;vertical-align:0em;"></span><span
                                        class="mord coloredeq eql" style=""><span class="mord mathnormal"
                                            style="">i</span></span></span></span></span></span> 는 각 레이어의 번호입니다.
                </p>
                <h2>압축 작업 훈련</h2>
                <p>BPTT를 사용한 훈련 압축은 매우 큰 계산 그래프(많은 타임 스텝)를 유지해야 하므로, 이 논문에서는 <em>자동 인코딩 손실</em>과 <em>어텐션 재구성 손실</em>을
                    제안합니다. 자동 인코딩 손실은 압축된
                    메모리에서 원본 메모리를 디코딩하여 손실을 계산합니다. 어텐션 재구성 손실은 압축된 메모리와 압축되지 않은 메모리에 대한 멀티 헤드 어텐션 결과를 계산하고 그 사이의 평균 제곱
                    오차를
                    구합니다. 여기서는 후자가 더 나은 결과를 제공하기 때문에 후자를 구현했습니다.</p>
                <p>이 구현은 사전 레이어 정규화를 사용하는 반면 논문은 사후 레이어 정규화를 사용합니다. 사전 레이어 정규화는 <a href="../feedforward.html">FFN</a> 및
                    셀프 어텐션 전에 레이어 정규화를 수행하며, residual
                    connection의 pass-through는
                    정규화되지 않습니다. 이러한 방법은 표준 트랜스포머에서 더 안정적일 것입니다.</p>
                <p>다음은 Tiny Shakespeare 데이터 세트에서 압축 변환기 모델을 학습하기 위한 <a href="experiment.html">학습 코드</a>와 노트북입니다.</p>
                <p><a
                        href="https://colab.research.google.com/github/labmlai/annotated_deep_learning_paper_implementations/blob/master/labml_nn/transformers/compressive/experiment.ipynb"><img
                            alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg"></a> </p>

            </div>
            <div class='code'>

            </div>
        </div>
        <div class='footer'>
            <a href="https://papers.labml.ai">Trending Research Papers</a>
            <a href="https://labml.ai">labml.ai</a>
        </div>
    </div>
    <script src=../../interactive.js?v=1"></script>
    <script>
        function handleImages() {
            var images = document.querySelectorAll('p>img')

            for (var i = 0; i < images.length; ++i) {
                handleImage(images[i])
            }
        }

        function handleImage(img) {
            img.parentElement.style.textAlign = 'center'

            var modal = document.createElement('div')
            modal.id = 'modal'

            var modalContent = document.createElement('div')
            modal.appendChild(modalContent)

            var modalImage = document.createElement('img')
            modalContent.appendChild(modalImage)

            var span = document.createElement('span')
            span.classList.add('close')
            span.textContent = 'x'
            modal.appendChild(span)

            img.onclick = function () {
                console.log('clicked')
                document.body.appendChild(modal)
                modalImage.src = img.src
            }

            span.onclick = function () {
                document.body.removeChild(modal)
            }
        }

        handleImages()
    </script>
</body>

</html>